<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: getParsedIORegInfo.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: getParsedIORegInfo.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module getParsedIORegInfo */
/*
Good info: https://www.cnet.com/news/about-the-os-x-byhost-preferences-directory/
*/
const PlistParser = require('./PlistParser.js');

/**
* Returns results from calls to such as `ioreg -rd1 -c IOPlatformExpertDevice`
* Based on `ioreg.c`
* @todo Put this into own library with `PlistParser` dependency?
* @param {string} str The string containing the ioreg data
* @returns {ParsedIORegResult[]}
*/
function getParsedIORegInfo (str) {
  str = str.trim();

  // e.g., +-o MacBookAir7,2  &lt;class IOPlatformExpertDevice, id 0x100000112, registered, matched, active, busy 0 (158524 ms), retain 42>
  // Todo: Support bold, etc.?
  const classInfo = /(?:^|\n)(?:(\+-o )|(?:[ |] )*)(\S+)(?:@(\S+))?\s+&lt;class (\w+)(?:, id 0x(\w+))?(?:, (!?)registered, (!?)matched, (in)?active, busy (\d+))?(?: \((\d+) ms\))?(?:, retain (\d+))?>([\s\S]+?)(?=\n\w|\s*$)/g;
  let match,
    isNode, ioServiceName, ioServiceLocation, ioServiceClass,
    id, notRegistered, notMatched, inactive, busyTime,
    accumulatedBusyTime, retainCount, plist;
  const matches = [];
  while ((match = classInfo.exec(str)) !== null) {
    [
      , isNode, ioServiceName, ioServiceLocation, ioServiceClass,
      id, notRegistered, notMatched, inactive, busyTime,
      accumulatedBusyTime, retainCount, plist
    ] = match;

    const parser = new PlistParser({plist, allowAngledBracketStrings: true, allowMissingSeparators: true});
    const info = parser.start();
    matches.push({
      isNode: Boolean(isNode),
      ioServiceName,
      ioServiceLocation: ioServiceLocation !== undefined ? ioServiceLocation : null,
      ioServiceClass,
      id: parseInt(id, 16),
      registered: !notRegistered,
      matched: !notMatched,
      active: !inactive,
      busyTime: parseInt(busyTime, 10),
      accumulatedBusyTime: parseInt(accumulatedBusyTime, 10),
      retainCount: retainCount ? parseInt(retainCount, 10) : null,
      info
    });
  }
  return matches;
}
if (typeof module !== 'undefined') {
  module.exports = getParsedIORegInfo;
} else {
  window.getParsedIORegInfo = getParsedIORegInfo; // eslint-disable-line no-undef
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-getParsedIORegInfo.html">getParsedIORegInfo</a></li><li><a href="module-MacOSDefaults.html">MacOSDefaults</a></li><li><a href="module-PlistParser.html">PlistParser</a></li></ul><h3>Classes</h3><ul><li><a href="module-MacOSDefaults-MacOSDefaults.html">MacOSDefaults</a></li><li><a href="module-PlistParser-PlistParser.html">PlistParser</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jun 26 2018 17:57:59 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
